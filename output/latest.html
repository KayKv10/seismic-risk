<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seismic Risk Assessment</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
          crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
            crossorigin=""></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont,
                'Segoe UI', Roboto, sans-serif;
        }
        #map { height: 100vh; width: 100%; }
        .airport-marker {
            background: none !important;
            border: none !important;
        }
        .airport-selected {
            filter: drop-shadow(0 0 6px rgba(0,100,255,0.8));
        }
        .sidebar {
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 1000;
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            max-width: 320px;
        }
        .sidebar h3 { margin-bottom: 10px; color: #333; }
        .sidebar p { margin: 5px 0; color: #666; font-size: 14px; }
        .sidebar .stat { font-weight: bold; color: #333; }
        .top-airports {
            margin-top: 12px;
            border-top: 1px solid #eee;
            padding-top: 8px;
        }
        .top-airports h4 {
            font-size: 13px;
            color: #333;
            margin-bottom: 6px;
        }
        .top-airport-item {
            display: flex;
            align-items: center;
            font-size: 12px;
            padding: 3px 0;
            border-bottom: 1px solid #f5f5f5;
        }
        .top-airport-item .rank {
            color: #999;
            width: 18px;
            flex-shrink: 0;
        }
        .top-airport-item .iata {
            font-weight: bold;
            color: #333;
            width: 36px;
            flex-shrink: 0;
        }
        .top-airport-item .ap-name {
            flex: 1;
            color: #666;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            margin: 0 6px;
        }
        .top-airport-item .score {
            font-weight: bold;
            color: #dc3545;
            flex-shrink: 0;
        }
        .legend {
            position: absolute;
            bottom: 30px;
            left: 10px;
            z-index: 1000;
            background: white;
            padding: 10px 15px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            max-width: 200px;
        }
        .legend h4 {
            margin-bottom: 8px;
            font-size: 13px;
            color: #333;
        }
        .legend-item {
            display: flex;
            align-items: center;
            margin: 4px 0;
            font-size: 12px;
        }
        .legend-diamond {
            flex-shrink: 0;
            margin-right: 8px;
        }
        .gradient-bar {
            width: 100%;
            height: 12px;
            border-radius: 3px;
            margin: 4px 0;
        }
        .gradient-labels {
            display: flex;
            justify-content: space-between;
            font-size: 10px;
            color: #888;
        }
        .legend-note {
            font-size: 10px;
            color: #999;
            margin-top: 8px;
            line-height: 1.4;
        }
        .leaflet-popup-content { min-width: 200px; }
        .popup-title {
            font-weight: bold;
            font-size: 14px;
            margin-bottom: 5px;
        }
        .popup-row {
            font-size: 12px;
            margin: 3px 0;
            color: #555;
        }
        .trend-section {
            margin-top: 12px;
            border-top: 1px solid #eee;
            padding-top: 8px;
        }
        .trend-section h4 {
            font-size: 13px;
            color: #333;
            margin-bottom: 6px;
        }
        .trend-item {
            display: flex;
            align-items: center;
            font-size: 12px;
            padding: 3px 0;
            border-bottom: 1px solid #f5f5f5;
        }
        .trend-item .iso {
            font-weight: bold;
            width: 36px;
            color: #333;
        }
        .trend-item .sparkline { flex: 1; margin: 0 6px; }
        .trend-item .delta {
            font-weight: bold;
            flex-shrink: 0;
            width: 50px;
            text-align: right;
        }
        .trend-up { color: #dc3545; }
        .trend-down { color: #28a745; }
        .trend-new { color: #6f42c1; }
        .trend-stable { color: #6c757d; }
    </style>
</head>
<body>
    <div id="map"></div>
    <div class="sidebar">
        <h3>Seismic Risk Assessment</h3>
        <p>Countries: <span class="stat" id="country-count">0</span></p>
        <p>Exposed airports:
            <span class="stat" id="airport-count">0</span></p>
        <p>Earthquakes:
            <span class="stat" id="quake-count">0</span></p>
        <div class="top-airports">
            <h4>Top 5 Most Exposed</h4>
            <div id="top-airports-list"></div>
        </div>
        <div class="trend-section" id="trend-section"
             style="display:none;">
            <h4>Score Trends</h4>
            <div id="trend-list"></div>
            <p style="font-size:10px;color:#999;margin-top:4px;">
                <span id="trend-range"></span>
            </p>
        </div>
        <p style="margin-top: 10px; font-size: 11px; color: #999;">
            Generated: 2026-02-16 06:54 UTC
        </p>
    </div>
    <div class="legend">
        <h4>Airport Exposure</h4>
        <div class="gradient-bar"
             style="background: linear-gradient(to right,
                 #28a745, #ffc107, #dc3545);">
        </div>
        <div class="gradient-labels">
            <span>Low</span><span>High</span>
        </div>

        <h4 style="margin-top: 10px;">Airport Size</h4>
        <div class="legend-item">
            <div class="legend-diamond">
                <svg width="14" height="14">
                    <polygon points="7,0 14,7 7,14 0,7"
                        fill="#888" stroke="#333"
                        stroke-width="1"/></svg>
            </div>
            &gt;300K movements/yr
        </div>
        <div class="legend-item">
            <div class="legend-diamond">
                <svg width="10" height="10">
                    <polygon points="5,0 10,5 5,10 0,5"
                        fill="#888" stroke="#333"
                        stroke-width="1"/></svg>
            </div>
            100-300K movements/yr
        </div>
        <div class="legend-item">
            <div class="legend-diamond">
                <svg width="7" height="7">
                    <polygon points="3.5,0 7,3.5 3.5,7 0,3.5"
                        fill="#888" stroke="#333"
                        stroke-width="1"/></svg>
            </div>
            &lt;100K movements/yr
        </div>

        <h4 style="margin-top: 10px;">Earthquake Shaking</h4>
        <div class="legend-item">
            <div style="width: 14px; height: 14px; border-radius: 50%;
                 background: rgb(251,191,36); opacity: 0.4;
                 margin-right: 8px; flex-shrink: 0;"></div>
            M3-4 (small area)
        </div>
        <div class="legend-item">
            <div style="width: 14px; height: 14px; border-radius: 50%;
                 background: rgb(245,158,11); opacity: 0.6;
                 margin-right: 8px; flex-shrink: 0;"></div>
            M5-6 (medium area)
        </div>
        <div class="legend-item">
            <div style="width: 14px; height: 14px; border-radius: 50%;
                 background: rgb(185,28,28); opacity: 0.8;
                 margin-right: 8px; flex-shrink: 0;"></div>
            M7+ (large area)
        </div>
        <div style="font-size: 10px; color: #999; margin-top: 4px;">
            Circle = estimated MMI V felt area
        </div>

        <p class="legend-note">
            Circle radius shows estimated area of strong
            shaking (MMI V). Click an airport to highlight
            its nearby quakes.
            Use layer controls (top-left) to toggle layers.
        </p>
    </div>

    <script>
        var data = {"type": "FeatureCollection", "features": [{"type": "Feature", "geometry": {"type": "Point", "coordinates": [125.646004, 7.12552]}, "properties": {"feature_type": "airport", "name": "Francisco Bangoy International Airport", "iata_code": "DVO", "municipality": "Davao", "country": "Philippines", "iso_alpha3": "PHL", "closest_quake_km": 192.8, "exposure_score": 0.63, "nearby_quake_count": 2, "country_risk_score": 15.86, "pager_alert": null, "aircraft_movements_k": 10.0, "max_pga_g": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[125.646004, 7.12552], [124.0105, 6.5177]]}, "properties": {"feature_type": "connection", "airport_iata": "DVO", "earthquake_id": "us6000s4yq", "distance_km": 192.8, "exposure_contribution": 0.36, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[125.646004, 7.12552], [123.9468, 6.5533]]}, "properties": {"feature_type": "connection", "airport_iata": "DVO", "earthquake_id": "us6000s8in", "distance_km": 198.1, "exposure_contribution": 0.27, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [125.096243, 6.057208]}, "properties": {"feature_type": "airport", "name": "General Santos International Airport", "iata_code": "GES", "municipality": "General Santos", "country": "Philippines", "iso_alpha3": "PHL", "closest_quake_km": 130.5, "exposure_score": 10.73, "nearby_quake_count": 16, "country_risk_score": 15.86, "pager_alert": null, "aircraft_movements_k": 10.0, "max_pga_g": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[125.096243, 6.057208], [124.0105, 6.5177]]}, "properties": {"feature_type": "connection", "airport_iata": "GES", "earthquake_id": "us6000s4yq", "distance_km": 130.5, "exposure_contribution": 0.68, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[125.096243, 6.057208], [123.9181, 6.4372]]}, "properties": {"feature_type": "connection", "airport_iata": "GES", "earthquake_id": "us6000s5d3", "distance_km": 136.9, "exposure_contribution": 0.63, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[125.096243, 6.057208], [123.9468, 6.5533]]}, "properties": {"feature_type": "connection", "airport_iata": "GES", "earthquake_id": "us6000s8in", "distance_km": 138.5, "exposure_contribution": 0.45, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[125.096243, 6.057208], [123.8961, 6.5648]]}, "properties": {"feature_type": "connection", "airport_iata": "GES", "earthquake_id": "us6000s4x4", "distance_km": 144.1, "exposure_contribution": 0.58, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[125.096243, 6.057208], [123.8079, 6.2973]]}, "properties": {"feature_type": "connection", "airport_iata": "GES", "earthquake_id": "us6000s543", "distance_km": 144.9, "exposure_contribution": 0.52, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[125.096243, 6.057208], [123.8277, 6.3984]]}, "properties": {"feature_type": "connection", "airport_iata": "GES", "earthquake_id": "us6000s4xy", "distance_km": 145.3, "exposure_contribution": 0.58, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[125.096243, 6.057208], [123.8484, 6.511]]}, "properties": {"feature_type": "connection", "airport_iata": "GES", "earthquake_id": "us6000s4ws", "distance_km": 146.9, "exposure_contribution": 0.8, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[125.096243, 6.057208], [123.801, 6.4232]]}, "properties": {"feature_type": "connection", "airport_iata": "GES", "earthquake_id": "us6000s4rf", "distance_km": 148.8, "exposure_contribution": 0.62, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[125.096243, 6.057208], [123.7821, 6.4204]]}, "properties": {"feature_type": "connection", "airport_iata": "GES", "earthquake_id": "us6000s4xz", "distance_km": 150.8, "exposure_contribution": 1.36, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[125.096243, 6.057208], [123.8098, 6.5222]]}, "properties": {"feature_type": "connection", "airport_iata": "GES", "earthquake_id": "us6000s4uf", "distance_km": 151.3, "exposure_contribution": 0.54, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[125.096243, 6.057208], [123.7256, 6.2931]]}, "properties": {"feature_type": "connection", "airport_iata": "GES", "earthquake_id": "us7000rr0l", "distance_km": 153.8, "exposure_contribution": 0.74, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[125.096243, 6.057208], [123.7166, 6.3557]]}, "properties": {"feature_type": "connection", "airport_iata": "GES", "earthquake_id": "us7000rqmd", "distance_km": 156.1, "exposure_contribution": 0.72, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[125.096243, 6.057208], [123.7338, 6.4453]]}, "properties": {"feature_type": "connection", "airport_iata": "GES", "earthquake_id": "us6000s4yl", "distance_km": 156.7, "exposure_contribution": 0.72, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[125.096243, 6.057208], [123.7553, 6.5145]]}, "properties": {"feature_type": "connection", "airport_iata": "GES", "earthquake_id": "us6000s4qp", "distance_km": 156.7, "exposure_contribution": 0.51, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[125.096243, 6.057208], [123.6886, 6.4524]]}, "properties": {"feature_type": "connection", "airport_iata": "GES", "earthquake_id": "us6000s51a", "distance_km": 161.7, "exposure_contribution": 0.43, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[125.096243, 6.057208], [123.6966, 6.5738]]}, "properties": {"feature_type": "connection", "airport_iata": "GES", "earthquake_id": "us6000s4yn", "distance_km": 165.0, "exposure_contribution": 0.83, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [124.456496, 8.612203]}, "properties": {"feature_type": "airport", "name": "Laguindingan International Airport", "iata_code": "CGY", "municipality": "Laguindingan", "country": "Philippines", "iso_alpha3": "PHL", "closest_quake_km": 190.3, "exposure_score": 0.21, "nearby_quake_count": 1, "country_risk_score": 15.86, "pager_alert": null, "aircraft_movements_k": 10.0, "max_pga_g": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[124.456496, 8.612203], [125.592, 9.9051]]}, "properties": {"feature_type": "connection", "airport_iata": "CGY", "earthquake_id": "us6000s6q8", "distance_km": 190.3, "exposure_contribution": 0.21, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [122.059998, 6.92242]}, "properties": {"feature_type": "airport", "name": "Zamboanga International Airport", "iata_code": "ZAM", "municipality": "Zamboanga", "country": "Philippines", "iso_alpha3": "PHL", "closest_quake_km": 184.8, "exposure_score": 4.07, "nearby_quake_count": 8, "country_risk_score": 15.86, "pager_alert": null, "aircraft_movements_k": 10.0, "max_pga_g": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[122.059998, 6.92242], [123.6966, 6.5738]]}, "properties": {"feature_type": "connection", "airport_iata": "ZAM", "earthquake_id": "us6000s4yn", "distance_km": 184.8, "exposure_contribution": 0.68, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[122.059998, 6.92242], [123.6886, 6.4524]]}, "properties": {"feature_type": "connection", "airport_iata": "ZAM", "earthquake_id": "us6000s51a", "distance_km": 187.3, "exposure_contribution": 0.34, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[122.059998, 6.92242], [123.7338, 6.4453]]}, "properties": {"feature_type": "connection", "airport_iata": "ZAM", "earthquake_id": "us6000s4yl", "distance_km": 192.3, "exposure_contribution": 0.51, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[122.059998, 6.92242], [123.7553, 6.5145]]}, "properties": {"feature_type": "connection", "airport_iata": "ZAM", "earthquake_id": "us6000s4qp", "distance_km": 192.6, "exposure_contribution": 0.36, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[122.059998, 6.92242], [123.7166, 6.3557]]}, "properties": {"feature_type": "connection", "airport_iata": "ZAM", "earthquake_id": "us7000rqmd", "distance_km": 193.5, "exposure_contribution": 0.5, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[122.059998, 6.92242], [123.7256, 6.2931]]}, "properties": {"feature_type": "connection", "airport_iata": "ZAM", "earthquake_id": "us7000rr0l", "distance_km": 196.8, "exposure_contribution": 0.49, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[122.059998, 6.92242], [123.7821, 6.4204]]}, "properties": {"feature_type": "connection", "airport_iata": "ZAM", "earthquake_id": "us6000s4xz", "distance_km": 198.2, "exposure_contribution": 0.85, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[122.059998, 6.92242], [123.8098, 6.5222]]}, "properties": {"feature_type": "connection", "airport_iata": "ZAM", "earthquake_id": "us6000s4uf", "distance_km": 198.3, "exposure_contribution": 0.34, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [123.97974, 10.309261]}, "properties": {"feature_type": "airport", "name": "Mactan Cebu International Airport", "iata_code": "CEB", "municipality": "Cebu City/Lapu-Lapu City", "country": "Philippines", "iso_alpha3": "PHL", "closest_quake_km": 182.1, "exposure_score": 0.22, "nearby_quake_count": 1, "country_risk_score": 15.86, "pager_alert": null, "aircraft_movements_k": 100.0, "max_pga_g": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[123.97974, 10.309261], [125.592, 9.9051]]}, "properties": {"feature_type": "connection", "airport_iata": "CEB", "earthquake_id": "us6000s6q8", "distance_km": 182.1, "exposure_contribution": 0.22, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [127.0728, 5.6166]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s98c", "magnitude": 5.3, "depth_km": 74.531, "felt_radius_km": 5.0, "date": "2026-02-14", "place": "128 km SE of Pondaguitan, Philippines", "country": "Philippines"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [125.592, 9.9051]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s6q8", "magnitude": 5, "depth_km": 152.224, "felt_radius_km": 5.0, "date": "2026-02-05", "place": "5 km S of Dinagat, Philippines", "country": "Philippines"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [123.9181, 6.4372]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s5d3", "magnitude": 5.1, "depth_km": 10, "felt_radius_km": 37.8, "date": "2026-01-30", "place": "14 km W of Sangay, Philippines", "country": "Philippines"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [123.8079, 6.2973]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s543", "magnitude": 5, "depth_km": 10, "felt_radius_km": 34.3, "date": "2026-01-28", "place": "30 km WSW of Sangay, Philippines", "country": "Philippines"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [123.6886, 6.4524]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s51a", "magnitude": 5, "depth_km": 10, "felt_radius_km": 34.3, "date": "2026-01-28", "place": "39 km WSW of Bantogon, Philippines", "country": "Philippines"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [124.0105, 6.5177]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s4yq", "magnitude": 5.1, "depth_km": 10, "felt_radius_km": 37.8, "date": "2026-01-28", "place": "3 km SW of Bantogon, Philippines", "country": "Philippines"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [123.6966, 6.5738]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s4yn", "magnitude": 5.6, "depth_km": 10, "felt_radius_km": 60.1, "date": "2026-01-28", "place": "37 km W of Bantogon, Philippines", "country": "Philippines"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [123.7338, 6.4453]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s4yl", "magnitude": 5.4, "depth_km": 10, "felt_radius_km": 50.1, "date": "2026-01-28", "place": "34 km W of Sangay, Philippines", "country": "Philippines"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [123.7821, 6.4204]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s4xz", "magnitude": 5.9, "depth_km": 10, "felt_radius_km": 78.5, "date": "2026-01-28", "place": "29 km W of Sangay, Philippines", "country": "Philippines"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [123.8277, 6.3984]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s4xy", "magnitude": 5.1, "depth_km": 10, "felt_radius_km": 37.8, "date": "2026-01-28", "place": "24 km WSW of Sangay, Philippines", "country": "Philippines"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [123.8961, 6.5648]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s4x4", "magnitude": 5.1, "depth_km": 10, "felt_radius_km": 37.8, "date": "2026-01-28", "place": "15 km WNW of Bantogon, Philippines", "country": "Philippines"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [123.8484, 6.511]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s4ws", "magnitude": 5.4, "depth_km": 10, "felt_radius_km": 50.1, "date": "2026-01-28", "place": "20 km W of Bantogon, Philippines", "country": "Philippines"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [123.8098, 6.5222]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s4uf", "magnitude": 5.1, "depth_km": 10, "felt_radius_km": 37.8, "date": "2026-01-27", "place": "24 km W of Bantogon, Philippines", "country": "Philippines"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [123.9468, 6.5533]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s8in", "magnitude": 5, "depth_km": 75.559, "felt_radius_km": 5.0, "date": "2026-01-27", "place": "9 km WNW of Bantogon, Philippines", "country": "Philippines"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [123.801, 6.4232]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s4rf", "magnitude": 5.2, "depth_km": 10, "felt_radius_km": 41.6, "date": "2026-01-27", "place": "27 km W of Sangay, Philippines", "country": "Philippines"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [123.7553, 6.5145]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s4qp", "magnitude": 5.1, "depth_km": 10, "felt_radius_km": 37.8, "date": "2026-01-27", "place": "30 km W of Bantogon, Philippines", "country": "Philippines"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [123.7256, 6.2931]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us7000rr0l", "magnitude": 5.4, "depth_km": 10, "felt_radius_km": 50.1, "date": "2026-01-21", "place": "39 km WSW of Sangay, Philippines", "country": "Philippines"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [123.7166, 6.3557]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us7000rqmd", "magnitude": 5.4, "depth_km": 10, "felt_radius_km": 50.1, "date": "2026-01-19", "place": "37 km WSW of Sangay, Philippines", "country": "Philippines"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [140.388714, 35.76858]}, "properties": {"feature_type": "airport", "name": "Narita International Airport", "iata_code": "NRT", "municipality": "Narita", "country": "Japan", "iso_alpha3": "JPN", "closest_quake_km": 123.3, "exposure_score": 0.57, "nearby_quake_count": 1, "country_risk_score": 8.23, "pager_alert": null, "aircraft_movements_k": 250.0, "max_pga_g": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[140.388714, 35.76858], [140.9958, 36.7639]]}, "properties": {"feature_type": "connection", "airport_iata": "NRT", "earthquake_id": "us6000s63e", "distance_km": 123.3, "exposure_contribution": 0.57, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [141.690414, 42.774753]}, "properties": {"feature_type": "airport", "name": "New Chitose Airport", "iata_code": "CTS", "municipality": "Sapporo", "country": "Japan", "iso_alpha3": "JPN", "closest_quake_km": 152.3, "exposure_score": 1.02, "nearby_quake_count": 2, "country_risk_score": 8.23, "pager_alert": null, "aircraft_movements_k": 10.0, "max_pga_g": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[141.690414, 42.774753], [141.9872, 41.4231]]}, "properties": {"feature_type": "connection", "airport_iata": "CTS", "earthquake_id": "us7000rqwc", "distance_km": 152.3, "exposure_contribution": 0.59, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[141.690414, 42.774753], [142.3698, 41.1383]]}, "properties": {"feature_type": "connection", "airport_iata": "CTS", "earthquake_id": "us7000rrc5", "distance_km": 190.4, "exposure_contribution": 0.43, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [140.822006, 41.77]}, "properties": {"feature_type": "airport", "name": "Hakodate Airport", "iata_code": "HKD", "municipality": "Hakodate", "country": "Japan", "iso_alpha3": "JPN", "closest_quake_km": 104.3, "exposure_score": 1.61, "nearby_quake_count": 2, "country_risk_score": 8.23, "pager_alert": null, "aircraft_movements_k": 10.0, "max_pga_g": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[140.822006, 41.77], [141.9872, 41.4231]]}, "properties": {"feature_type": "connection", "airport_iata": "HKD", "earthquake_id": "us7000rqwc", "distance_km": 104.3, "exposure_contribution": 0.97, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[140.822006, 41.77], [142.3698, 41.1383]]}, "properties": {"feature_type": "connection", "airport_iata": "HKD", "earthquake_id": "us7000rrc5", "distance_km": 146.9, "exposure_contribution": 0.64, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [140.689477, 40.733777]}, "properties": {"feature_type": "airport", "name": "Aomori Airport", "iata_code": "AOJ", "municipality": "Aomori", "country": "Japan", "iso_alpha3": "JPN", "closest_quake_km": 133.1, "exposure_score": 1.35, "nearby_quake_count": 2, "country_risk_score": 8.23, "pager_alert": null, "aircraft_movements_k": 10.0, "max_pga_g": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[140.689477, 40.733777], [141.9872, 41.4231]]}, "properties": {"feature_type": "connection", "airport_iata": "AOJ", "earthquake_id": "us7000rqwc", "distance_km": 133.1, "exposure_contribution": 0.72, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[140.689477, 40.733777], [142.3698, 41.1383]]}, "properties": {"feature_type": "connection", "airport_iata": "AOJ", "earthquake_id": "us7000rrc5", "distance_km": 148.1, "exposure_contribution": 0.63, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [140.917007, 38.139702]}, "properties": {"feature_type": "airport", "name": "Sendai Airport", "iata_code": "SDJ", "municipality": "Natori", "country": "Japan", "iso_alpha3": "JPN", "closest_quake_km": 153.1, "exposure_score": 0.42, "nearby_quake_count": 1, "country_risk_score": 8.23, "pager_alert": null, "aircraft_movements_k": 10.0, "max_pga_g": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[140.917007, 38.139702], [140.9958, 36.7639]]}, "properties": {"feature_type": "connection", "airport_iata": "SDJ", "earthquake_id": "us6000s63e", "distance_km": 153.1, "exposure_contribution": 0.42, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [139.786958, 35.549678]}, "properties": {"feature_type": "airport", "name": "Tokyo Haneda International Airport", "iata_code": "HND", "municipality": "Tokyo", "country": "Japan", "iso_alpha3": "JPN", "closest_quake_km": 173.2, "exposure_score": 0.35, "nearby_quake_count": 1, "country_risk_score": 8.23, "pager_alert": null, "aircraft_movements_k": 480.0, "max_pga_g": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[139.786958, 35.549678], [140.9958, 36.7639]]}, "properties": {"feature_type": "connection", "airport_iata": "HND", "earthquake_id": "us6000s63e", "distance_km": 173.2, "exposure_contribution": 0.35, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [127.639804, 26.192437]}, "properties": {"feature_type": "airport", "name": "Naha International Airport", "iata_code": "OKA", "municipality": "Naha", "country": "Japan", "iso_alpha3": "JPN", "closest_quake_km": 108.6, "exposure_score": 1.44, "nearby_quake_count": 1, "country_risk_score": 8.23, "pager_alert": null, "aircraft_movements_k": 10.0, "max_pga_g": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[127.639804, 26.192437], [128.6169, 25.7653]]}, "properties": {"feature_type": "connection", "airport_iata": "OKA", "earthquake_id": "us6000s8l6", "distance_km": 108.6, "exposure_contribution": 1.44, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [127.769444, 26.351667]}, "properties": {"feature_type": "airport", "name": "Kadena Air Base", "iata_code": "DNA", "municipality": "Okinawa", "country": "Japan", "iso_alpha3": "JPN", "closest_quake_km": 106.9, "exposure_score": 1.47, "nearby_quake_count": 1, "country_risk_score": 8.23, "pager_alert": null, "aircraft_movements_k": 10.0, "max_pga_g": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[127.769444, 26.351667], [128.6169, 25.7653]]}, "properties": {"feature_type": "connection", "airport_iata": "DNA", "earthquake_id": "us6000s8l6", "distance_km": 106.9, "exposure_contribution": 1.47, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [128.6169, 25.7653]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s8l6", "magnitude": 5.5, "depth_km": 10, "felt_radius_km": 54.9, "date": "2026-02-12", "place": "97 km SE of Katsuren-haebaru, Japan", "country": "Japan"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [148.9281, 43.9991]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s8l3", "magnitude": 5, "depth_km": 10, "felt_radius_km": 34.3, "date": "2026-02-12", "place": "159 km SSE of Kuril\u2019sk, Russia", "country": "Japan"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [148.844, 43.9926]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s8i0", "magnitude": 5.4, "depth_km": 10, "felt_radius_km": 50.1, "date": "2026-02-12", "place": "157 km SSE of Kuril\u2019sk, Russia", "country": "Japan"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [130.3779, 29.1198]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s6gs", "magnitude": 5.5, "depth_km": 29, "felt_radius_km": 47.7, "date": "2026-02-04", "place": "106 km NE of Tatsug\u014d, Japan", "country": "Japan"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [140.9958, 36.7639]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s63e", "magnitude": 5, "depth_km": 59.65, "felt_radius_km": 5.0, "date": "2026-02-03", "place": "22 km E of Kitaibaraki, Japan", "country": "Japan"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [143.061, 40.2618]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s4z6", "magnitude": 5.1, "depth_km": 26.615, "felt_radius_km": 28.7, "date": "2026-01-28", "place": "107 km E of Noda, Japan", "country": "Japan"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [146.3815, 42.9662]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s4n9", "magnitude": 5.2, "depth_km": 35, "felt_radius_km": 24.6, "date": "2026-01-27", "place": "76 km ESE of Nemuro, Japan", "country": "Japan"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [142.3698, 41.1383]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us7000rrc5", "magnitude": 5.3, "depth_km": 55.847, "felt_radius_km": 5.0, "date": "2026-01-22", "place": "94 km E of Yokohama, Japan", "country": "Japan"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [141.9872, 41.4231]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us7000rqwc", "magnitude": 5.3, "depth_km": 62.109, "felt_radius_km": 5.0, "date": "2026-01-20", "place": "66 km ENE of Mutsu, Japan", "country": "Japan"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [122.5068, 23.9423]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us7000rq95", "magnitude": 5, "depth_km": 10, "felt_radius_km": 34.3, "date": "2026-01-17", "place": "76 km SW of Yonakuni, Japan", "country": "Japan"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [142.1796, 29.8969]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us7000rq8a", "magnitude": 5, "depth_km": 10, "felt_radius_km": 34.3, "date": "2026-01-17", "place": "Izu Islands, Japan region", "country": "Japan"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-175.149164, -21.241438]}, "properties": {"feature_type": "airport", "name": "Fua'amotu International Airport", "iata_code": "TBU", "municipality": "Nuku'alofa", "country": "Tonga", "iso_alpha3": "TON", "closest_quake_km": 74.4, "exposure_score": 7.78, "nearby_quake_count": 5, "country_risk_score": 7.78, "pager_alert": null, "aircraft_movements_k": 10.0, "max_pga_g": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[-175.149164, -21.241438], [-174.9315, -21.8789]]}, "properties": {"feature_type": "connection", "airport_iata": "TBU", "earthquake_id": "us7000rs1z", "distance_km": 74.4, "exposure_contribution": 2.21, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[-175.149164, -21.241438], [-174.7776, -21.8553]]}, "properties": {"feature_type": "connection", "airport_iata": "TBU", "earthquake_id": "us7000rs4b", "distance_km": 78.3, "exposure_contribution": 1.46, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[-175.149164, -21.241438], [-174.7478, -21.906]]}, "properties": {"feature_type": "connection", "airport_iata": "TBU", "earthquake_id": "us7000rs3s", "distance_km": 84.8, "exposure_contribution": 1.32, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[-175.149164, -21.241438], [-174.1337, -21.019]]}, "properties": {"feature_type": "connection", "airport_iata": "TBU", "earthquake_id": "us6000s5s7", "distance_km": 108.2, "exposure_contribution": 2.04, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[-175.149164, -21.241438], [-174.4852, -22.3569]]}, "properties": {"feature_type": "connection", "airport_iata": "TBU", "earthquake_id": "us7000rqf7", "distance_km": 141.7, "exposure_contribution": 0.76, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-173.3102, -15.1196]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s9f6", "magnitude": 5.3, "depth_km": 10, "felt_radius_km": 45.7, "date": "2026-02-15", "place": "106 km NNE of Hihifo, Tonga", "country": "Tonga"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-173.2848, -15.3591]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s8mg", "magnitude": 5, "depth_km": 35, "felt_radius_km": 7.4, "date": "2026-02-13", "place": "85 km NE of Hihifo, Tonga", "country": "Tonga"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-172.9395, -14.97]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s7pk", "magnitude": 5.6, "depth_km": 10, "felt_radius_km": 60.1, "date": "2026-02-10", "place": "142 km NE of Hihifo, Tonga", "country": "Tonga"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-178.3348, -21.0396]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s7p7", "magnitude": 6.2, "depth_km": 510.944, "felt_radius_km": 5.0, "date": "2026-02-10", "place": "Fiji region", "country": "Tonga"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-173.5346, -16.107]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s7hn", "magnitude": 5, "depth_km": 32.263, "felt_radius_km": 15.4, "date": "2026-02-09", "place": "32 km ESE of Hihifo, Tonga", "country": "Tonga"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-178.5952, -29.5951]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s6cx", "magnitude": 6.1, "depth_km": 184.162, "felt_radius_km": 5.0, "date": "2026-02-04", "place": "Kermadec Islands, New Zealand", "country": "Tonga"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-176.2788, -26.9354]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s6bf", "magnitude": 5.3, "depth_km": 10, "felt_radius_km": 45.7, "date": "2026-02-04", "place": "south of the Fiji Islands", "country": "Tonga"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-173.0865, -15.3423]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s694", "magnitude": 5.2, "depth_km": 10, "felt_radius_km": 41.6, "date": "2026-02-03", "place": "101 km NE of Hihifo, Tonga", "country": "Tonga"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-174.1337, -21.019]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s5s7", "magnitude": 5.8, "depth_km": 12, "felt_radius_km": 71.6, "date": "2026-01-31", "place": "92 km ENE of \u2018Ohonua, Tonga", "country": "Tonga"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-176.7306, -28.7586]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s5h4", "magnitude": 5, "depth_km": 10, "felt_radius_km": 34.3, "date": "2026-01-30", "place": "Kermadec Islands region", "country": "Tonga"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-177.1841, -29.1576]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s5de", "magnitude": 5.2, "depth_km": 35, "felt_radius_km": 24.6, "date": "2026-01-30", "place": "Kermadec Islands, New Zealand", "country": "Tonga"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-177.068, -29.3754]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s4m2", "magnitude": 5.2, "depth_km": 10, "felt_radius_km": 41.6, "date": "2026-01-26", "place": "Kermadec Islands, New Zealand", "country": "Tonga"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-174.7776, -21.8553]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us7000rs4b", "magnitude": 5.1, "depth_km": 10, "felt_radius_km": 37.8, "date": "2026-01-26", "place": "59 km SSE of \u2018Ohonua, Tonga", "country": "Tonga"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-177.2429, -29.4953]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us7000rs3x", "magnitude": 5.4, "depth_km": 14.061, "felt_radius_km": 49.1, "date": "2026-01-26", "place": "Kermadec Islands, New Zealand", "country": "Tonga"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-174.7478, -21.906]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us7000rs3s", "magnitude": 5.2, "depth_km": 35, "felt_radius_km": 24.6, "date": "2026-01-26", "place": "66 km SSE of \u2018Ohonua, Tonga", "country": "Tonga"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-174.9315, -21.8789]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us7000rs1z", "magnitude": 5.4, "depth_km": 10, "felt_radius_km": 50.1, "date": "2026-01-26", "place": "59 km S of \u2018Ohonua, Tonga", "country": "Tonga"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-178.7822, -21.0582]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us7000rrsg", "magnitude": 5, "depth_km": 589.434, "felt_radius_km": 5.0, "date": "2026-01-24", "place": "Fiji region", "country": "Tonga"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-173.9302, -16.3651]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us7000rqit", "magnitude": 5.1, "depth_km": 107.219, "felt_radius_km": 5.0, "date": "2026-01-19", "place": "47 km SSW of Hihifo, Tonga", "country": "Tonga"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-174.4852, -22.3569]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us7000rqf7", "magnitude": 5.3, "depth_km": 10, "felt_radius_km": 45.7, "date": "2026-01-18", "place": "122 km SSE of \u2018Ohonua, Tonga", "country": "Tonga"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-178.2765, -30.4272]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us7000rq8y", "magnitude": 5.2, "depth_km": 57.768, "felt_radius_km": 5.0, "date": "2026-01-17", "place": "Kermadec Islands, New Zealand", "country": "Tonga"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [111.947222, -7.750278]}, "properties": {"feature_type": "airport", "name": "Dhoho International Airport", "iata_code": "DHX", "municipality": "Kediri", "country": "Indonesia", "iso_alpha3": "IDN", "closest_quake_km": 58.6, "exposure_score": 2.52, "nearby_quake_count": 2, "country_risk_score": 6.93, "pager_alert": null, "aircraft_movements_k": 10.0, "max_pga_g": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[111.947222, -7.750278], [111.4371, -7.8988]]}, "properties": {"feature_type": "connection", "airport_iata": "DHX", "earthquake_id": "us6000s4mj", "distance_km": 58.6, "exposure_contribution": 1.23, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[111.947222, -7.750278], [111.2264, -8.7865]]}, "properties": {"feature_type": "connection", "airport_iata": "DHX", "earthquake_id": "us6000s6ne", "distance_km": 139.9, "exposure_contribution": 1.29, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [140.519857, -2.579627]}, "properties": {"feature_type": "airport", "name": "Dortheys Hiyo Eluay International Airport", "iata_code": "DJJ", "municipality": "Sentani", "country": "Indonesia", "iso_alpha3": "IDN", "closest_quake_km": 190.4, "exposure_score": 0.32, "nearby_quake_count": 1, "country_risk_score": 6.93, "pager_alert": null, "aircraft_movements_k": 10.0, "max_pga_g": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[140.519857, -2.579627], [138.8285, -2.3049]]}, "properties": {"feature_type": "connection", "airport_iata": "DJJ", "earthquake_id": "us7000rqe0", "distance_km": 190.4, "exposure_contribution": 0.32, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [124.92625, 1.548591]}, "properties": {"feature_type": "airport", "name": "Sam Ratulangi International Airport", "iata_code": "MDC", "municipality": "Manado", "country": "Indonesia", "iso_alpha3": "IDN", "closest_quake_km": 114.6, "exposure_score": 0.61, "nearby_quake_count": 1, "country_risk_score": 6.93, "pager_alert": null, "aircraft_movements_k": 10.0, "max_pga_g": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[124.92625, 1.548591], [125.2815, 0.5812]]}, "properties": {"feature_type": "connection", "airport_iata": "MDC", "earthquake_id": "us7000rqdm", "distance_km": 114.6, "exposure_contribution": 0.61, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [110.431999, -7.78818]}, "properties": {"feature_type": "airport", "name": "Adisutjipto International Airport", "iata_code": "JOG", "municipality": "Yogyakarta", "country": "Indonesia", "iso_alpha3": "IDN", "closest_quake_km": 111.4, "exposure_score": 2.17, "nearby_quake_count": 2, "country_risk_score": 6.93, "pager_alert": null, "aircraft_movements_k": 10.0, "max_pga_g": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[110.431999, -7.78818], [111.4371, -7.8988]]}, "properties": {"feature_type": "connection", "airport_iata": "JOG", "earthquake_id": "us6000s4mj", "distance_km": 111.4, "exposure_contribution": 0.9, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[110.431999, -7.78818], [111.2264, -8.7865]]}, "properties": {"feature_type": "connection", "airport_iata": "JOG", "earthquake_id": "us6000s6ne", "distance_km": 141.3, "exposure_contribution": 1.27, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [112.787003, -7.37983]}, "properties": {"feature_type": "airport", "name": "Juanda International Airport", "iata_code": "SUB", "municipality": "Surabaya", "country": "Indonesia", "iso_alpha3": "IDN", "closest_quake_km": 159.6, "exposure_score": 0.65, "nearby_quake_count": 1, "country_risk_score": 6.93, "pager_alert": null, "aircraft_movements_k": 10.0, "max_pga_g": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[112.787003, -7.37983], [111.4371, -7.8988]]}, "properties": {"feature_type": "connection", "airport_iata": "SUB", "earthquake_id": "us6000s4mj", "distance_km": 159.6, "exposure_contribution": 0.65, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [110.373244, -6.970732]}, "properties": {"feature_type": "airport", "name": "Jenderal Ahmad Yani Airport", "iata_code": "SRG", "municipality": "Semarang", "country": "Indonesia", "iso_alpha3": "IDN", "closest_quake_km": 156.2, "exposure_score": 0.66, "nearby_quake_count": 1, "country_risk_score": 6.93, "pager_alert": null, "aircraft_movements_k": 10.0, "max_pga_g": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[110.373244, -6.970732], [111.4371, -7.8988]]}, "properties": {"feature_type": "connection", "airport_iata": "SRG", "earthquake_id": "us6000s4mj", "distance_km": 156.2, "exposure_contribution": 0.66, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [102.3859, -4.3562]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s9ci", "magnitude": 5, "depth_km": 66.131, "felt_radius_km": 5.0, "date": "2026-02-15", "place": "62 km SSE of Bengkulu, Indonesia", "country": "Indonesia"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [128.2588, 4.2222]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s8rt", "magnitude": 5.6, "depth_km": 56.368, "felt_radius_km": 23.2, "date": "2026-02-13", "place": "277 km N of Tobelo, Indonesia", "country": "Indonesia"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [126.7988, 2.3162]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s7es", "magnitude": 5, "depth_km": 44.944, "felt_radius_km": 5.0, "date": "2026-02-09", "place": "149 km WNW of Tobelo, Indonesia", "country": "Indonesia"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [111.2264, -8.7865]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s6ne", "magnitude": 5.8, "depth_km": 40, "felt_radius_km": 60.6, "date": "2026-02-05", "place": "94 km SW of Trenggalek, Indonesia", "country": "Indonesia"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [132.0522, -6.8285]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s6b3", "magnitude": 5.1, "depth_km": 11.096, "felt_radius_km": 37.5, "date": "2026-02-04", "place": "153 km SSW of Tual, Indonesia", "country": "Indonesia"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [129.9107, -6.6119]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s62k", "magnitude": 5.2, "depth_km": 141.538, "felt_radius_km": 5.0, "date": "2026-02-03", "place": "Banda Sea", "country": "Indonesia"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [124.4803, -0.272]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s5d8", "magnitude": 5, "depth_km": 91.195, "felt_radius_km": 5.0, "date": "2026-01-30", "place": "80 km S of Modisi, Indonesia", "country": "Indonesia"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [118.2996, -8.6184]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s52m", "magnitude": 5.1, "depth_km": 133.558, "felt_radius_km": 5.0, "date": "2026-01-28", "place": "20 km WSW of Dompu, Indonesia", "country": "Indonesia"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [130.3413, -7.2698]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s51i", "magnitude": 5, "depth_km": 7.175, "felt_radius_km": 35.0, "date": "2026-01-28", "place": "Pulau Pulau Tanimbar, Indonesia", "country": "Indonesia"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [111.4371, -7.8988]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s4mj", "magnitude": 5.7, "depth_km": 127, "felt_radius_km": 5.0, "date": "2026-01-27", "place": "4 km SW of Ponorogo, Indonesia", "country": "Indonesia"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [130.5864, -6.1987]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us7000rrx3", "magnitude": 5.1, "depth_km": 136.694, "felt_radius_km": 5.0, "date": "2026-01-25", "place": "247 km WSW of Tual, Indonesia", "country": "Indonesia"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [122.6765, -0.2053]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us7000rr7x", "magnitude": 5.1, "depth_km": 87.962, "felt_radius_km": 5.0, "date": "2026-01-21", "place": "83 km N of Luwuk, Indonesia", "country": "Indonesia"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [102.194, -2.5876]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us7000rqjg", "magnitude": 5, "depth_km": 166.679, "felt_radius_km": 5.0, "date": "2026-01-19", "place": "104 km NNW of Curup, Indonesia", "country": "Indonesia"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [138.8285, -2.3049]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us7000rqe0", "magnitude": 5, "depth_km": 30.9, "felt_radius_km": 18.0, "date": "2026-01-18", "place": "203 km W of Abepura, Indonesia", "country": "Indonesia"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [125.2815, 0.5812]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us7000rqdm", "magnitude": 5, "depth_km": 63.203, "felt_radius_km": 5.0, "date": "2026-01-18", "place": "89 km SSE of Tondano, Indonesia", "country": "Indonesia"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [158.451068, 53.168716]}, "properties": {"feature_type": "airport", "name": "Yelizovo Airport", "iata_code": "PKC", "municipality": "Petropavlovsk-Kamchatsky", "country": "Russia", "iso_alpha3": "RUS", "closest_quake_km": 94.0, "exposure_score": 3.92, "nearby_quake_count": 5, "country_risk_score": 3.92, "pager_alert": null, "aircraft_movements_k": 10.0, "max_pga_g": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[158.451068, 53.168716], [159.8442, 53.0471]]}, "properties": {"feature_type": "connection", "airport_iata": "PKC", "earthquake_id": "us6000s6ve", "distance_km": 94.0, "exposure_contribution": 0.89, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[158.451068, 53.168716], [158.5253, 51.7914]]}, "properties": {"feature_type": "connection", "airport_iata": "PKC", "earthquake_id": "us7000rrbj", "distance_km": 153.2, "exposure_contribution": 1.75, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[158.451068, 53.168716], [159.6355, 51.9126]]}, "properties": {"feature_type": "connection", "airport_iata": "PKC", "earthquake_id": "us6000s7m0", "distance_km": 161.0, "exposure_contribution": 0.45, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[158.451068, 53.168716], [160.8818, 52.4708]]}, "properties": {"feature_type": "connection", "airport_iata": "PKC", "earthquake_id": "us7000rq9h", "distance_km": 180.8, "exposure_contribution": 0.5, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[158.451068, 53.168716], [159.9598, 51.7554]]}, "properties": {"feature_type": "connection", "airport_iata": "PKC", "earthquake_id": "us7000rs26", "distance_km": 187.5, "exposure_contribution": 0.33, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [154.5612, 48.3271]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s9ei", "magnitude": 6, "depth_km": 54.981, "felt_radius_km": 66.5, "date": "2026-02-15", "place": "284 km SSW of Severo-Kuril\u2019sk, Russia", "country": "Russia"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [178.3977, 51.9921]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s96i", "magnitude": 5, "depth_km": 111.268, "felt_radius_km": 5.0, "date": "2026-02-14", "place": "Rat Islands, Aleutian Islands, Alaska", "country": "Russia"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [147.5111, 44.2631]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s7vd", "magnitude": 5.1, "depth_km": 74.551, "felt_radius_km": 5.0, "date": "2026-02-11", "place": "81 km NE of Shikotan, Russia", "country": "Russia"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [146.4857, 57.8988]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s7s6", "magnitude": 5.6, "depth_km": 10, "felt_radius_km": 60.1, "date": "2026-02-11", "place": "250 km SE of Okhotsk, Russia", "country": "Russia"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [159.6355, 51.9126]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s7m0", "magnitude": 5.1, "depth_km": 49.073, "felt_radius_km": 5.0, "date": "2026-02-10", "place": "140 km SE of Vilyuchinsk, Russia", "country": "Russia"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [159.6802, 51.3672]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s7e3", "magnitude": 5.3, "depth_km": 10, "felt_radius_km": 45.7, "date": "2026-02-09", "place": "194 km SSE of Vilyuchinsk, Russia", "country": "Russia"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [159.8442, 53.0471]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s6ve", "magnitude": 5.1, "depth_km": 58.734, "felt_radius_km": 5.0, "date": "2026-02-06", "place": "81 km E of Petropavlovsk-Kamchatsky, Russia", "country": "Russia"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [161.6441, 56.1712]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s628", "magnitude": 5, "depth_km": 72.245, "felt_radius_km": 5.0, "date": "2026-02-03", "place": "52 km W of Ust\u2019-Kamchatsk Staryy, Russia", "country": "Russia"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [159.3527, 51.2858]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s4yu", "magnitude": 5.2, "depth_km": 35, "felt_radius_km": 24.6, "date": "2026-01-28", "place": "194 km SSE of Vilyuchinsk, Russia", "country": "Russia"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [160.0786, 51.6656]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s4yk", "magnitude": 5.1, "depth_km": 10, "felt_radius_km": 37.8, "date": "2026-01-28", "place": "181 km SE of Vilyuchinsk, Russia", "country": "Russia"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [159.3213, 51.3609]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s4yg", "magnitude": 5, "depth_km": 35, "felt_radius_km": 7.4, "date": "2026-01-28", "place": "185 km SSE of Vilyuchinsk, Russia", "country": "Russia"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [159.7734, 50.5054]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s4nn", "magnitude": 5, "depth_km": 10, "felt_radius_km": 34.3, "date": "2026-01-27", "place": "254 km ESE of Ozernovskiy, Russia", "country": "Russia"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [159.2617, 51.4104]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s4me", "magnitude": 5, "depth_km": 10, "felt_radius_km": 34.3, "date": "2026-01-27", "place": "179 km SSE of Vilyuchinsk, Russia", "country": "Russia"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [158.1085, 50.2772]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us7000rs4q", "magnitude": 5, "depth_km": 10, "felt_radius_km": 34.3, "date": "2026-01-26", "place": "147 km ESE of Severo-Kuril\u2019sk, Russia", "country": "Russia"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [160.3308, 51.718]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us7000rs3j", "magnitude": 5.1, "depth_km": 10, "felt_radius_km": 37.8, "date": "2026-01-26", "place": "188 km SE of Vilyuchinsk, Russia", "country": "Russia"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [159.9598, 51.7554]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us7000rs26", "magnitude": 5, "depth_km": 23.161, "felt_radius_km": 27.3, "date": "2026-01-26", "place": "168 km SE of Vilyuchinsk, Russia", "country": "Russia"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [177.3723, 52.1792]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us7000rrjh", "magnitude": 5.1, "depth_km": 10, "felt_radius_km": 37.8, "date": "2026-01-23", "place": "293 km ESE of Attu Station, Alaska", "country": "Russia"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [158.5253, 51.7914]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us7000rrbj", "magnitude": 6.2, "depth_km": 47, "felt_radius_km": 90.9, "date": "2026-01-22", "place": "127 km S of Vilyuchinsk, Russia", "country": "Russia"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [160.8818, 52.4708]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us7000rq9h", "magnitude": 5.3, "depth_km": 17.173, "felt_radius_km": 43.5, "date": "2026-01-17", "place": "165 km ESE of Petropavlovsk-Kamchatsky, Russia", "country": "Russia"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [146.726544, -6.567995]}, "properties": {"feature_type": "airport", "name": "Nadzab Tomodachi International Airport", "iata_code": "LAE", "municipality": "Lae", "country": "Papua New Guinea", "iso_alpha3": "PNG", "closest_quake_km": 101.9, "exposure_score": 1.75, "nearby_quake_count": 2, "country_risk_score": 1.75, "pager_alert": null, "aircraft_movements_k": 10.0, "max_pga_g": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[146.726544, -6.567995], [147.5856, -6.2352]]}, "properties": {"feature_type": "connection", "airport_iata": "LAE", "earthquake_id": "us6000s692", "distance_km": 101.9, "exposure_contribution": 0.84, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[146.726544, -6.567995], [145.9777, -5.3293]]}, "properties": {"feature_type": "connection", "airport_iata": "LAE", "earthquake_id": "us7000rqrt", "distance_km": 160.7, "exposure_contribution": 0.92, "pga_g": null, "mmi": null}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [153.0049, -4.2269]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s7v9", "magnitude": 5.1, "depth_km": 10, "felt_radius_km": 37.8, "date": "2026-02-11", "place": "82 km E of Kokopo, Papua New Guinea", "country": "Papua New Guinea"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [150.0844, -5.6004]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s6bp", "magnitude": 5.1, "depth_km": 143.776, "felt_radius_km": 5.0, "date": "2026-02-04", "place": "8 km SW of Kimbe, Papua New Guinea", "country": "Papua New Guinea"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [147.5856, -6.2352]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s692", "magnitude": 5.2, "depth_km": 70.182, "felt_radius_km": 5.0, "date": "2026-02-03", "place": "45 km NW of Finschhafen, Papua New Guinea", "country": "Papua New Guinea"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [153.9147, -5.4427]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s5bl", "magnitude": 5, "depth_km": 80.556, "felt_radius_km": 5.0, "date": "2026-01-29", "place": "198 km WNW of Panguna, Papua New Guinea", "country": "Papua New Guinea"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [143.5656, -6.5616]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us6000s4jy", "magnitude": 5.6, "depth_km": 19, "felt_radius_km": 57.9, "date": "2026-01-26", "place": "46 km SSW of Mendi, Papua New Guinea", "country": "Papua New Guinea"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [145.9777, -5.3293]}, "properties": {"feature_type": "earthquake", "earthquake_id": "us7000rqrt", "magnitude": 5.9, "depth_km": 103, "felt_radius_km": 5.0, "date": "2026-01-20", "place": "24 km ESE of Madang, Papua New Guinea", "country": "Papua New Guinea"}}]};
        var trendData = {"date": "2026-02-16", "history_days": 81, "history_start": "2020-01-31", "countries": {"PHL": {"scores": [3.64, 8.85, 0.71, 5.56, 3.25, 8.71, 4.99, 2.16, 14.18, 2.36, 10.89, 9.3, 7.37, 13.26, 16.05, 2.58, 2.07, 2.16, 1.16, 5.48, 20.1, 4.9, 9.41, 1.19, 13.64, 11.53, 13.97, 5.46, 7.29, 1.05, 12.02, 16.66, 4.88, 1.91, 6.0, 2.01, 5.72, 8.6, 14.64, 46.83, 1.59, 6.57, 1.1, 2.26, 2.56, 2.03, 10.68, 3.88, 2.98, 13.4, 9.67, 1.48, 3.29, 9.05, 3.62, 4.44, 1.84, 49.41, 5.47, 19.93, 16.26, 16.26, 16.26, 16.26, 16.24, 15.75, 15.75, 15.39, 15.86], "dates": ["2020-02-29", "2020-03-31", "2020-04-30", "2020-05-31", "2020-06-30", "2020-08-31", "2020-09-30", "2020-11-30", "2020-12-31", "2021-01-31", "2021-02-28", "2021-05-31", "2021-06-30", "2021-07-31", "2021-08-31", "2021-10-31", "2021-11-30", "2021-12-31", "2022-01-31", "2022-02-28", "2022-03-31", "2022-04-30", "2022-05-31", "2022-06-30", "2022-07-31", "2022-08-31", "2022-10-31", "2022-11-30", "2022-12-31", "2023-01-31", "2023-02-28", "2023-03-31", "2023-04-30", "2023-05-31", "2023-06-30", "2023-07-31", "2023-08-31", "2023-10-31", "2023-11-30", "2023-12-31", "2024-01-31", "2024-02-29", "2024-03-31", "2024-04-30", "2024-05-31", "2024-07-31", "2024-08-31", "2024-09-30", "2024-11-30", "2024-12-31", "2025-01-31", "2025-02-28", "2025-03-31", "2025-04-30", "2025-06-30", "2025-07-31", "2025-09-30", "2025-10-31", "2025-11-30", "2026-01-31", "2026-02-08", "2026-02-09", "2026-02-10", "2026-02-11", "2026-02-12", "2026-02-13", "2026-02-14", "2026-02-15", "2026-02-16"], "current": 15.86, "previous": 15.39, "delta": 0.47, "direction": "stable", "is_new": false, "days_tracked": 69}, "JPN": {"scores": [8.54, 2.36, 1.18, 14.97, 23.45, 5.83, 2.93, 6.69, 2.67, 6.37, 3.04, 17.77, 15.01, 3.91, 18.14, 5.48, 7.92, 6.45, 1.64, 16.58, 14.78, 18.89, 9.67, 37.09, 8.82, 15.66, 6.8, 6.19, 5.06, 8.17, 7.39, 2.68, 16.67, 0.94, 3.7, 2.16, 3.13, 50.64, 16.54, 0.32, 4.11, 2.52, 3.52, 9.78, 4.57, 43.06, 1.19, 7.66, 35.51, 2.09, 10.22, 104.16, 6.99, 0.57, 11.52, 2.91, 54.89, 3.54, 0.57, 7.5, 5.21, 1.06, 1.09, 11.7, 4.41, 14.53, 41.52, 18.29, 9.3, 9.3, 9.3, 9.3, 9.3, 12.21, 12.21, 10.5, 8.23], "dates": ["2020-01-31", "2020-02-29", "2020-03-31", "2020-04-30", "2020-05-31", "2020-06-30", "2020-08-31", "2020-09-30", "2020-11-30", "2020-12-31", "2021-01-31", "2021-02-28", "2021-03-31", "2021-04-30", "2021-05-31", "2021-06-30", "2021-07-31", "2021-08-31", "2021-09-30", "2021-10-31", "2021-12-31", "2022-01-31", "2022-02-28", "2022-03-31", "2022-04-30", "2022-05-31", "2022-06-30", "2022-07-31", "2022-08-31", "2022-09-30", "2022-10-31", "2022-11-30", "2022-12-31", "2023-01-31", "2023-02-28", "2023-03-31", "2023-04-30", "2023-05-31", "2023-06-30", "2023-07-31", "2023-08-31", "2023-09-30", "2023-10-31", "2023-11-30", "2023-12-31", "2024-01-31", "2024-02-29", "2024-03-31", "2024-04-30", "2024-06-30", "2024-07-31", "2024-08-31", "2024-09-30", "2024-10-31", "2024-11-30", "2024-12-31", "2025-01-31", "2025-02-28", "2025-03-31", "2025-04-30", "2025-05-31", "2025-06-30", "2025-07-31", "2025-08-31", "2025-10-31", "2025-11-30", "2025-12-31", "2026-01-31", "2026-02-08", "2026-02-09", "2026-02-10", "2026-02-11", "2026-02-12", "2026-02-13", "2026-02-14", "2026-02-15", "2026-02-16"], "current": 8.23, "previous": 10.5, "delta": -2.27, "direction": "down", "is_new": false, "days_tracked": 77}, "TON": {"scores": [9.52, 7.76, 1.83, 5.26, 3.53, 1.79, 3.12, 3.38, 0.67, 7.1, 1.73, 3.81, 1.49, 5.64, 0.51, 5.86, 5.39, 2.84, 11.38, 4.95, 3.21, 3.55, 8.36, 8.55, 4.51, 2.56, 3.69, 1.69, 10.06, 2.15, 0.3, 2.09, 2.36, 3.23, 1.56, 6.02, 0.24, 1.19, 4.48, 0.9, 3.36, 0.2, 2.71, 0.27, 5.02, 5.88, 3.12, 3.86, 1.65, 3.32, 7.63, 4.19, 9.27, 2.08, 10.81, 6.09, 3.05, 5.1, 2.59, 14.83, 2.66, 4.34, 1.05, 3.06, 3.67, 0.53, 5.38, 7.42, 7.42, 7.42, 7.45, 7.45, 7.78, 7.78, 7.78, 7.78], "dates": ["2020-01-31", "2020-02-29", "2020-03-31", "2020-04-30", "2020-05-31", "2020-06-30", "2020-07-31", "2020-08-31", "2020-09-30", "2020-10-31", "2020-11-30", "2020-12-31", "2021-01-31", "2021-02-28", "2021-04-30", "2021-05-31", "2021-07-31", "2021-08-31", "2021-09-30", "2021-10-31", "2021-11-30", "2021-12-31", "2022-01-31", "2022-02-28", "2022-03-31", "2022-04-30", "2022-05-31", "2022-06-30", "2022-07-31", "2022-08-31", "2022-09-30", "2022-10-31", "2022-11-30", "2022-12-31", "2023-01-31", "2023-02-28", "2023-03-31", "2023-04-30", "2023-05-31", "2023-06-30", "2023-07-31", "2023-09-30", "2023-10-31", "2023-11-30", "2023-12-31", "2024-01-31", "2024-02-29", "2024-03-31", "2024-04-30", "2024-05-31", "2024-06-30", "2024-07-31", "2024-08-31", "2024-09-30", "2024-10-31", "2024-11-30", "2024-12-31", "2025-01-31", "2025-02-28", "2025-03-31", "2025-04-30", "2025-05-31", "2025-06-30", "2025-07-31", "2025-08-31", "2025-11-30", "2026-01-31", "2026-02-08", "2026-02-09", "2026-02-10", "2026-02-11", "2026-02-12", "2026-02-13", "2026-02-14", "2026-02-15", "2026-02-16"], "current": 7.78, "previous": 7.78, "delta": 0.0, "direction": "stable", "is_new": false, "days_tracked": 76}, "IDN": {"scores": [2.57, 1.37, 4.98, 1.21, 1.37, 1.99, 0.95, 1.6, 2.72, 2.22, 1.66, 0.7, 8.32, 5.69, 4.13, 1.49, 1.4, 0.52, 5.09, 2.69, 3.23, 8.66, 2.07, 4.07, 3.52, 1.15, 2.16, 2.0, 3.02, 2.83, 5.98, 8.29, 15.08, 28.8, 0.42, 3.6, 2.42, 2.89, 1.1, 1.42, 3.96, 1.65, 8.12, 0.66, 2.79, 4.53, 4.29, 4.49, 3.37, 2.19, 2.78, 2.35, 0.35, 1.34, 2.19, 1.55, 4.84, 1.04, 1.49, 2.32, 0.31, 0.75, 3.1, 1.62, 4.84, 2.18, 1.84, 5.67, 8.24, 8.31, 8.31, 8.31, 8.31, 7.98, 7.98, 7.98, 6.93], "dates": ["2020-01-31", "2020-02-29", "2020-03-31", "2020-04-30", "2020-06-30", "2020-07-31", "2020-08-31", "2020-09-30", "2020-11-30", "2020-12-31", "2021-01-31", "2021-02-28", "2021-04-30", "2021-05-31", "2021-06-30", "2021-07-31", "2021-08-31", "2021-09-30", "2021-10-31", "2021-11-30", "2021-12-31", "2022-01-31", "2022-02-28", "2022-03-31", "2022-04-30", "2022-05-31", "2022-06-30", "2022-07-31", "2022-08-31", "2022-09-30", "2022-11-30", "2022-12-31", "2023-01-31", "2023-02-28", "2023-03-31", "2023-04-30", "2023-06-30", "2023-07-31", "2023-08-31", "2023-09-30", "2023-10-31", "2023-11-30", "2023-12-31", "2024-01-31", "2024-02-29", "2024-03-31", "2024-04-30", "2024-05-31", "2024-06-30", "2024-07-31", "2024-08-31", "2024-09-30", "2024-10-31", "2024-11-30", "2024-12-31", "2025-01-31", "2025-02-28", "2025-03-31", "2025-04-30", "2025-05-31", "2025-06-30", "2025-07-31", "2025-08-31", "2025-09-30", "2025-10-31", "2025-11-30", "2025-12-31", "2026-01-31", "2026-02-08", "2026-02-09", "2026-02-10", "2026-02-11", "2026-02-12", "2026-02-13", "2026-02-14", "2026-02-15", "2026-02-16"], "current": 6.93, "previous": 7.98, "delta": -1.05, "direction": "down", "is_new": false, "days_tracked": 77}, "RUS": {"scores": [1.73, 1.08, 0.35, 2.35, 1.29, 0.32, 1.12, 0.66, 0.44, 2.16, 0.54, 2.16, 5.05, 0.72, 1.69, 0.52, 0.76, 13.41, 0.79, 1.07, 144.18, 28.44, 57.98, 9.02, 13.87, 2.85, 5.32, 5.44, 5.46, 4.14, 4.59, 4.22, 4.55, 3.92, 3.92, 3.92], "dates": ["2020-01-31", "2020-02-29", "2020-04-30", "2020-09-30", "2021-01-31", "2021-04-30", "2021-07-31", "2021-08-31", "2021-10-31", "2022-06-30", "2022-11-30", "2022-12-31", "2023-04-30", "2023-10-31", "2023-12-31", "2024-05-31", "2024-06-30", "2024-08-31", "2024-11-30", "2024-12-31", "2025-07-31", "2025-08-31", "2025-09-30", "2025-10-31", "2025-11-30", "2025-12-31", "2026-01-31", "2026-02-08", "2026-02-09", "2026-02-10", "2026-02-11", "2026-02-12", "2026-02-13", "2026-02-14", "2026-02-15", "2026-02-16"], "current": 3.92, "previous": 3.92, "delta": 0.0, "direction": "stable", "is_new": false, "days_tracked": 36}, "PNG": {"scores": [0.32, 0.85, 0.29, 1.91, 3.5, 4.63, 1.3, 4.15, 2.73, 1.43, 0.29, 0.67, 0.53, 0.65, 1.95, 2.24, 0.46, 1.83, 0.32, 0.27, 0.47, 5.37, 5.2, 15.78, 0.95, 1.39, 1.47, 0.89, 0.93, 0.49, 16.39, 2.88, 0.34, 1.55, 1.46, 0.72, 5.89, 0.89, 2.73, 0.39, 1.27, 1.33, 3.51, 1.69, 1.68, 6.2, 0.41, 2.02, 1.24, 1.79, 1.79, 1.78, 1.75, 1.75, 1.75, 1.75, 1.75, 1.75], "dates": ["2020-01-31", "2020-02-29", "2020-08-31", "2020-09-30", "2020-10-31", "2020-11-30", "2020-12-31", "2021-01-31", "2021-02-28", "2021-03-31", "2021-05-31", "2021-06-30", "2021-07-31", "2021-09-30", "2021-11-30", "2022-01-31", "2022-02-28", "2022-03-31", "2022-04-30", "2022-05-31", "2022-06-30", "2022-07-31", "2022-08-31", "2022-09-30", "2022-10-31", "2023-01-31", "2023-02-28", "2023-03-31", "2023-04-30", "2023-05-31", "2023-10-31", "2023-11-30", "2023-12-31", "2024-01-31", "2024-03-31", "2024-04-30", "2024-05-31", "2024-06-30", "2024-08-31", "2024-09-30", "2025-01-31", "2025-03-31", "2025-04-30", "2025-06-30", "2025-07-31", "2025-10-31", "2025-11-30", "2025-12-31", "2026-01-31", "2026-02-08", "2026-02-09", "2026-02-10", "2026-02-11", "2026-02-12", "2026-02-13", "2026-02-14", "2026-02-15", "2026-02-16"], "current": 1.75, "previous": 1.75, "delta": 0.0, "direction": "stable", "is_new": false, "days_tracked": 58}}, "airports": {"DVO": {"scores": [0.36, 0.36, 0.36, 0.36, 0.36, 0.36, 0.36, 0.63], "dates": ["2026-02-09", "2026-02-10", "2026-02-11", "2026-02-12", "2026-02-13", "2026-02-14", "2026-02-15", "2026-02-16"], "current": 0.63, "previous": 0.36, "delta": 0.27, "direction": "stable", "is_new": false, "days_tracked": 8}, "GES": {"scores": [10.16, 10.16, 10.16, 10.13, 10.07, 10.07, 10.22, 10.73], "dates": ["2026-02-09", "2026-02-10", "2026-02-11", "2026-02-12", "2026-02-13", "2026-02-14", "2026-02-15", "2026-02-16"], "current": 10.73, "previous": 10.22, "delta": 0.51, "direction": "up", "is_new": false, "days_tracked": 8}, "CGY": {"scores": [0.21, 0.21, 0.21, 0.21, 0.21, 0.21, 0.21, 0.21], "dates": ["2026-02-09", "2026-02-10", "2026-02-11", "2026-02-12", "2026-02-13", "2026-02-14", "2026-02-15", "2026-02-16"], "current": 0.21, "previous": 0.21, "delta": 0.0, "direction": "stable", "is_new": false, "days_tracked": 8}, "ZAM": {"scores": [5.31, 5.31, 5.31, 5.32, 4.89, 4.89, 4.38, 4.07], "dates": ["2026-02-09", "2026-02-10", "2026-02-11", "2026-02-12", "2026-02-13", "2026-02-14", "2026-02-15", "2026-02-16"], "current": 4.07, "previous": 4.38, "delta": -0.31, "direction": "stable", "is_new": false, "days_tracked": 8}, "CEB": {"scores": [0.22, 0.22, 0.22, 0.22, 0.22, 0.22, 0.22, 0.22], "dates": ["2026-02-09", "2026-02-10", "2026-02-11", "2026-02-12", "2026-02-13", "2026-02-14", "2026-02-15", "2026-02-16"], "current": 0.22, "previous": 0.22, "delta": 0.0, "direction": "stable", "is_new": false, "days_tracked": 8}, "NRT": {"scores": [0.57, 0.57, 0.57, 0.57, 0.57, 0.57, 0.57, 0.57], "dates": ["2026-02-09", "2026-02-10", "2026-02-11", "2026-02-12", "2026-02-13", "2026-02-14", "2026-02-15", "2026-02-16"], "current": 0.57, "previous": 0.57, "delta": 0.0, "direction": "stable", "is_new": false, "days_tracked": 8}, "CTS": {"scores": [1.5, 1.5, 1.5, 1.5, 1.5, 1.5, 1.5, 1.02], "dates": ["2026-02-09", "2026-02-10", "2026-02-11", "2026-02-12", "2026-02-13", "2026-02-14", "2026-02-15", "2026-02-16"], "current": 1.02, "previous": 1.5, "delta": -0.48, "direction": "stable", "is_new": false, "days_tracked": 8}, "HKD": {"scores": [2.53, 2.53, 2.53, 2.53, 2.53, 2.53, 2.53, 1.61], "dates": ["2026-02-09", "2026-02-10", "2026-02-11", "2026-02-12", "2026-02-13", "2026-02-14", "2026-02-15", "2026-02-16"], "current": 1.61, "previous": 2.53, "delta": -0.92, "direction": "down", "is_new": false, "days_tracked": 8}, "AOJ": {"scores": [2.22, 2.22, 2.22, 2.22, 2.22, 2.22, 2.22, 1.35], "dates": ["2026-02-09", "2026-02-10", "2026-02-11", "2026-02-12", "2026-02-13", "2026-02-14", "2026-02-15", "2026-02-16"], "current": 1.35, "previous": 2.22, "delta": -0.87, "direction": "down", "is_new": false, "days_tracked": 8}, "SDJ": {"scores": [0.42, 0.42, 0.42, 0.42, 0.42, 0.42, 0.42, 0.42], "dates": ["2026-02-09", "2026-02-10", "2026-02-11", "2026-02-12", "2026-02-13", "2026-02-14", "2026-02-15", "2026-02-16"], "current": 0.42, "previous": 0.42, "delta": 0.0, "direction": "stable", "is_new": false, "days_tracked": 8}, "HND": {"scores": [0.35, 0.35, 0.35, 0.35, 0.35, 0.35, 0.35, 0.35], "dates": ["2026-02-09", "2026-02-10", "2026-02-11", "2026-02-12", "2026-02-13", "2026-02-14", "2026-02-15", "2026-02-16"], "current": 0.35, "previous": 0.35, "delta": 0.0, "direction": "stable", "is_new": false, "days_tracked": 8}, "OKA": {"scores": [1.44, 1.44, 1.44, 1.44], "dates": ["2026-02-13", "2026-02-14", "2026-02-15", "2026-02-16"], "current": 1.44, "previous": 1.44, "delta": 0.0, "direction": "stable", "is_new": false, "days_tracked": 4}, "DNA": {"scores": [1.47, 1.47, 1.47, 1.47], "dates": ["2026-02-13", "2026-02-14", "2026-02-15", "2026-02-16"], "current": 1.47, "previous": 1.47, "delta": 0.0, "direction": "stable", "is_new": false, "days_tracked": 4}, "TBU": {"scores": [7.42, 7.42, 7.45, 7.45, 7.78, 7.78, 7.78, 7.78], "dates": ["2026-02-09", "2026-02-10", "2026-02-11", "2026-02-12", "2026-02-13", "2026-02-14", "2026-02-15", "2026-02-16"], "current": 7.78, "previous": 7.78, "delta": 0.0, "direction": "stable", "is_new": false, "days_tracked": 8}, "DHX": {"scores": [2.45, 2.45, 2.45, 2.45, 2.52, 2.52, 2.52, 2.52], "dates": ["2026-02-09", "2026-02-10", "2026-02-11", "2026-02-12", "2026-02-13", "2026-02-14", "2026-02-15", "2026-02-16"], "current": 2.52, "previous": 2.52, "delta": 0.0, "direction": "stable", "is_new": false, "days_tracked": 8}, "DJJ": {"scores": [0.32, 0.32, 0.32, 0.32, 0.32, 0.32, 0.32, 0.32], "dates": ["2026-02-09", "2026-02-10", "2026-02-11", "2026-02-12", "2026-02-13", "2026-02-14", "2026-02-15", "2026-02-16"], "current": 0.32, "previous": 0.32, "delta": 0.0, "direction": "stable", "is_new": false, "days_tracked": 8}, "MDC": {"scores": [1.05, 1.05, 1.05, 1.05, 0.61, 0.61, 0.61, 0.61], "dates": ["2026-02-09", "2026-02-10", "2026-02-11", "2026-02-12", "2026-02-13", "2026-02-14", "2026-02-15", "2026-02-16"], "current": 0.61, "previous": 0.61, "delta": 0.0, "direction": "stable", "is_new": false, "days_tracked": 8}, "JOG": {"scores": [2.2, 2.2, 2.2, 2.2, 2.17, 2.17, 2.17, 2.17], "dates": ["2026-02-09", "2026-02-10", "2026-02-11", "2026-02-12", "2026-02-13", "2026-02-14", "2026-02-15", "2026-02-16"], "current": 2.17, "previous": 2.17, "delta": 0.0, "direction": "stable", "is_new": false, "days_tracked": 8}, "SUB": {"scores": [0.6, 0.6, 0.6, 0.6, 0.65, 0.65, 0.65, 0.65], "dates": ["2026-02-09", "2026-02-10", "2026-02-11", "2026-02-12", "2026-02-13", "2026-02-14", "2026-02-15", "2026-02-16"], "current": 0.65, "previous": 0.65, "delta": 0.0, "direction": "stable", "is_new": false, "days_tracked": 8}, "SRG": {"scores": [0.64, 0.64, 0.64, 0.64, 0.66, 0.66, 0.66, 0.66], "dates": ["2026-02-09", "2026-02-10", "2026-02-11", "2026-02-12", "2026-02-13", "2026-02-14", "2026-02-15", "2026-02-16"], "current": 0.66, "previous": 0.66, "delta": 0.0, "direction": "stable", "is_new": false, "days_tracked": 8}, "PKC": {"scores": [5.46, 4.14, 4.59, 4.22, 4.55, 3.92, 3.92, 3.92], "dates": ["2026-02-09", "2026-02-10", "2026-02-11", "2026-02-12", "2026-02-13", "2026-02-14", "2026-02-15", "2026-02-16"], "current": 3.92, "previous": 3.92, "delta": 0.0, "direction": "stable", "is_new": false, "days_tracked": 8}, "LAE": {"scores": [1.79, 1.78, 1.75, 1.75, 1.75, 1.75, 1.75, 1.75], "dates": ["2026-02-09", "2026-02-10", "2026-02-11", "2026-02-12", "2026-02-13", "2026-02-14", "2026-02-15", "2026-02-16"], "current": 1.75, "previous": 1.75, "delta": 0.0, "direction": "stable", "is_new": false, "days_tracked": 8}}};

        // Categorize features
        var airports = data.features.filter(
            function(f) {
                return f.properties.feature_type === 'airport';
            }
        );
        var quakes = data.features.filter(
            function(f) {
                return f.properties.feature_type === 'earthquake';
            }
        );
        var connections = data.features.filter(
            function(f) {
                return f.properties.feature_type === 'connection';
            }
        );
        var countries = {};
        airports.forEach(function(f) {
            countries[f.properties.country] = true;
        });

        // Build set of quake IDs that appear in connections
        var connectedQuakeIds = {};
        connections.forEach(function(f) {
            connectedQuakeIds[f.properties.earthquake_id] = true;
        });
        var nearbyQuakes = quakes.filter(function(f) {
            return connectedQuakeIds[f.properties.earthquake_id] === true;
        });

        document.getElementById('country-count').textContent =
            Object.keys(countries).length;
        document.getElementById('airport-count').textContent =
            airports.length;
        document.getElementById('quake-count').textContent =
            quakes.length;

        // Top 5 most exposed airports
        var sorted = airports.slice().sort(function(a, b) {
            return b.properties.exposure_score
                - a.properties.exposure_score;
        });
        var top5 = sorted.slice(0, 5);
        var listEl = document.getElementById('top-airports-list');
        top5.forEach(function(f, i) {
            var p = f.properties;
            var item = document.createElement('div');
            item.className = 'top-airport-item';
            var nm = p.name.length > 22
                ? p.name.substring(0, 22) + '...' : p.name;
            item.innerHTML =
                '<span class="rank">' + (i + 1) + '.</span>'
                + '<span class="iata">' + p.iata_code + '</span>'
                + '<span class="ap-name">' + nm + '</span>'
                + '<span class="score">'
                + p.exposure_score.toFixed(1) + '</span>';
            listEl.appendChild(item);
        });

        // Sparkline builder (pure SVG, no dependencies)
        function buildSparkline(scores) {
            if (scores.length < 2) return '';
            var w = 80, h = 24, pad = 2;
            var min = Math.min.apply(null, scores);
            var max = Math.max.apply(null, scores);
            var range = max - min || 1;
            var step = (w - 2 * pad) / (scores.length - 1);
            var points = scores.map(function(s, i) {
                var x = pad + i * step;
                var y = h - pad
                    - ((s - min) / range) * (h - 2 * pad);
                return x.toFixed(1) + ',' + y.toFixed(1);
            }).join(' ');
            var last = scores[scores.length - 1];
            var first = scores[0];
            var color = last > first ? '#dc3545'
                : last < first ? '#28a745' : '#6c757d';
            return '<svg width="' + w + '" height="' + h
                + '" viewBox="0 0 ' + w + ' ' + h + '">'
                + '<polyline points="' + points
                + '" fill="none" stroke="' + color
                + '" stroke-width="1.5"'
                + ' stroke-linecap="round"'
                + ' stroke-linejoin="round"/></svg>';
        }

        // Populate trend sidebar section
        if (trendData !== null) {
            document.getElementById('trend-section')
                .style.display = '';
            document.getElementById('trend-range')
                .textContent = trendData.history_start + ' to ' + trendData.date
                    + ' (' + trendData.history_days + ' snapshots)';
            var seen = {};
            var trendEntries = [];
            airports.forEach(function(f) {
                var iso3 = f.properties.iso_alpha3;
                if (trendData.countries[iso3] && !seen[iso3]) {
                    seen[iso3] = true;
                    trendEntries.push({
                        iso3: iso3,
                        data: trendData.countries[iso3],
                    });
                }
            });
            trendEntries.sort(function(a, b) {
                return Math.abs(b.data.delta)
                    - Math.abs(a.data.delta);
            });
            var trendList = document
                .getElementById('trend-list');
            trendEntries.slice(0, 7).forEach(function(entry) {
                var d = entry.data;
                var item = document.createElement('div');
                item.className = 'trend-item';
                var svg = buildSparkline(d.scores);
                var deltaClass = d.direction === 'up'
                    ? 'trend-up'
                    : d.direction === 'down' ? 'trend-down'
                    : d.direction === 'new' ? 'trend-new'
                    : 'trend-stable';
                var deltaText = d.direction === 'new'
                    ? 'NEW'
                    : d.direction === 'stable' ? '~'
                    : (d.delta > 0 ? '+' : '')
                        + d.delta.toFixed(1);
                item.innerHTML =
                    '<span class="iso">' + entry.iso3
                    + '</span>'
                    + '<span class="sparkline">'
                    + svg + '</span>'
                    + '<span class="delta ' + deltaClass
                    + '">' + deltaText + '</span>';
                trendList.appendChild(item);
            });
        }

        // Initialize map
        var map = L.map('map').setView([20, 0], 2);
        L.tileLayer(
            'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',
            {
                attribution:
                    '&copy; <a href="https://www.openstreetmap.org/'
                    + 'copyright">OSM</a>',
                maxZoom: 18,
            }
        ).addTo(map);

        // Exposure color: green -> yellow -> red
        var maxScore = 1;
        airports.forEach(function(f) {
            if (f.properties.exposure_score > maxScore)
                maxScore = f.properties.exposure_score;
        });

        function exposureColor(score) {
            var t = Math.min(score / maxScore, 1);
            var r, g, b;
            if (t < 0.5) {
                var s = t * 2;
                r = Math.round(40 + (255 - 40) * s);
                g = Math.round(167 + (193 - 167) * s);
                b = Math.round(69 + (7 - 69) * s);
            } else {
                var s2 = (t - 0.5) * 2;
                r = Math.round(255 + (220 - 255) * s2);
                g = Math.round(193 + (53 - 193) * s2);
                b = Math.round(7 + (69 - 7) * s2);
            }
            return 'rgb(' + r + ',' + g + ',' + b + ')';
        }

        // Airport size by movement volume (3 tiers, thousands)
        function airportSize(movementsK) {
            if (movementsK >= 300) return 18;
            if (movementsK >= 100) return 13;
            return 9;
        }

        // Diamond SVG for airport markers
        function airportSVG(color, size) {
            var h = size / 2;
            var pts = h+',0 '+size+','+h+' '+h+','+size+' 0,'+h;
            return '<svg width="' + size + '" height="' + size
                + '"><polygon points="' + pts + '" fill="' + color
                + '" stroke="#333" stroke-width="1.5"'
                + ' fill-opacity="0.85"/></svg>';
        }

        // Connection layer (OFF by default)
        var maxContrib = 1;
        connections.forEach(function(f) {
            if (f.properties.exposure_contribution > maxContrib)
                maxContrib = f.properties.exposure_contribution;
        });

        var connectionLayer = L.geoJSON(
            { type: 'FeatureCollection', features: connections },
            {
                style: function(feature) {
                    var c = feature.properties.exposure_contribution;
                    var op = 0.3 + 0.5 * (c / maxContrib);
                    return {
                        color: '#666',
                        weight: 2,
                        dashArray: '6, 4',
                        opacity: op,
                    };
                },
            }
        );

        // Earthquake color by magnitude (amber -> dark red)
        function quakeColor(mag) {
            var t = Math.min(Math.max((mag - 3) / 5, 0), 1);
            var r = Math.round(251 + (185 - 251) * t);
            var g = Math.round(191 + (28 - 191) * t);
            var b = Math.round(36 + (28 - 36) * t);
            return 'rgb(' + r + ',' + g + ',' + b + ')';
        }
        function quakeOpacity(mag) {
            return 0.25 + 0.45
                * Math.min(Math.max((mag - 3) / 5, 0), 1);
        }

        // Shared earthquake rendering (geographic circles)
        function quakePointToLayer(feature, latlng) {
            var p = feature.properties;
            return L.circle(latlng, {
                radius: p.felt_radius_km * 1000,
                fillColor: quakeColor(p.magnitude),
                color: quakeColor(p.magnitude),
                weight: 1,
                opacity: 0.7,
                fillOpacity: quakeOpacity(p.magnitude),
            });
        }
        function quakePopup(feature, layer) {
            var p = feature.properties;
            layer.bindPopup(
                '<div class="popup-title">'
                + 'M' + p.magnitude + ' Earthquake</div>'
                + '<div class="popup-row">Place: '
                + p.place + '</div>'
                + '<div class="popup-row">Depth: '
                + p.depth_km + ' km</div>'
                + '<div class="popup-row">Felt radius: '
                + p.felt_radius_km + ' km</div>'
                + '<div class="popup-row">Date: '
                + p.date + '</div>'
                + '<div class="popup-row">Country: '
                + p.country + '</div>'
            );
        }

        // Two earthquake layers (both OFF by default, mutually exclusive)
        var nearbyQuakeLayer = L.geoJSON(
            { type: 'FeatureCollection', features: nearbyQuakes },
            { pointToLayer: quakePointToLayer, onEachFeature: quakePopup }
        );
        var allQuakeLayer = L.geoJSON(
            { type: 'FeatureCollection', features: quakes },
            { pointToLayer: quakePointToLayer, onEachFeature: quakePopup }
        );

        // Airport layer (ON by default)
        var airportLayer = L.geoJSON(
            { type: 'FeatureCollection', features: airports },
            {
                pointToLayer: function(feature, latlng) {
                    var p = feature.properties;
                    var color = exposureColor(p.exposure_score);
                    var size = airportSize(p.aircraft_movements_k);
                    var icon = L.divIcon({
                        html: airportSVG(color, size),
                        className: 'airport-marker',
                        iconSize: [size, size],
                        iconAnchor: [size / 2, size / 2],
                        popupAnchor: [0, -size / 2],
                    });
                    return L.marker(latlng, { icon: icon });
                },
                onEachFeature: function(feature, layer) {
                    var p = feature.properties;
                    var movements = p.aircraft_movements_k >= 10
                        ? Math.round(p.aircraft_movements_k)
                            + 'K movements/yr'
                        : 'N/A';
                    layer.bindPopup(
                        '<div class="popup-title">'
                        + p.name + '</div>'
                        + '<div class="popup-row">IATA: '
                        + p.iata_code + '</div>'
                        + '<div class="popup-row">'
                        + p.country
                        + ' (' + p.iso_alpha3 + ')</div>'
                        + '<div class="popup-row">'
                        + 'Aircraft movements: '
                        + movements + '</div>'
                        + '<div class="popup-row">'
                        + 'Exposure score: '
                        + p.exposure_score.toFixed(1) + '</div>'
                        + '<div class="popup-row">Nearby quakes: '
                        + p.nearby_quake_count + '</div>'
                        + '<div class="popup-row">Closest quake: '
                        + p.closest_quake_km + ' km</div>'
                        + '<div class="popup-row">'
                        + 'Country score: '
                        + p.country_risk_score + '</div>'
                        + (p.max_pga_g !== null
                            ? '<div class="popup-row">'
                                + 'ShakeMap PGA: '
                                + p.max_pga_g.toFixed(4)
                                + 'g</div>'
                            : '')
                        + (function() {
                            if (!trendData
                                || !trendData.countries[
                                    p.iso_alpha3])
                                return '';
                            var ct = trendData.countries[
                                p.iso_alpha3];
                            var cls = ct.direction === 'up'
                                ? 'trend-up'
                                : ct.direction === 'down'
                                ? 'trend-down'
                                : 'trend-stable';
                            var txt = ct.direction === 'new'
                                ? 'NEW'
                                : (ct.delta > 0 ? '+' : '')
                                    + ct.delta.toFixed(1);
                            var arrow = ct.direction === 'up'
                                ? '&#9650; '
                                : ct.direction === 'down'
                                ? '&#9660; '
                                : '';
                            return '<div class="popup-row">'
                                + '<span class="' + cls
                                + '">' + arrow + txt
                                + '</span> vs previous'
                                + '</div>';
                        })()
                        + (function() {
                            if (!trendData
                                || !trendData.airports
                                || !trendData.airports[
                                    p.iata_code])
                                return '';
                            var at = trendData.airports[
                                p.iata_code];
                            var svg = buildSparkline(at.scores);
                            if (!svg) return '';
                            var cls2 = at.direction === 'up'
                                ? 'trend-up'
                                : at.direction === 'down'
                                ? 'trend-down'
                                : 'trend-stable';
                            var dtxt = at.direction === 'new'
                                ? 'NEW'
                                : at.direction === 'stable'
                                ? '~'
                                : (at.delta > 0 ? '+' : '')
                                    + at.delta.toFixed(1);
                            return '<div class="popup-row"'
                                + ' style="margin-top:6px;'
                                + 'border-top:1px solid #eee;'
                                + 'padding-top:4px;">'
                                + '<div style="font-size:11px;'
                                + 'color:#888;margin-bottom:'
                                + '2px;">Exposure trend ('
                                + at.days_tracked
                                + ' snapshots)</div>'
                                + svg
                                + ' <span class="' + cls2
                                + '">' + dtxt + '</span>'
                                + '</div>';
                        })()
                    );
                    layer.on('click', function() {
                        justSelected = true;
                        selectAirport(p.iata_code, layer);
                    });
                },
            }
        );

        // Only airports on by default
        airportLayer.addTo(map);

        // Layer control (top-left, expanded)
        L.control.layers(null, {
            'Airports': airportLayer,
            'Quakes near airports': nearbyQuakeLayer,
            'All quakes in region': allQuakeLayer,
            'Connections': connectionLayer,
        }, { position: 'topleft', collapsed: false }).addTo(map);

        // Mutual exclusion for earthquake layers
        function syncLayerCheckbox(targetLayer, checked) {
            var id = L.stamp(targetLayer);
            var container = document.querySelector(
                '.leaflet-control-layers-overlays');
            if (!container) return;
            var inputs = container.querySelectorAll('input');
            inputs.forEach(function(input) {
                if (input.layerId === id) {
                    input.checked = checked;
                }
            });
        }

        map.on('overlayadd', function(e) {
            if (e.name === 'Quakes near airports'
                    && map.hasLayer(allQuakeLayer)) {
                map.removeLayer(allQuakeLayer);
                syncLayerCheckbox(allQuakeLayer, false);
            }
            if (e.name === 'All quakes in region'
                    && map.hasLayer(nearbyQuakeLayer)) {
                map.removeLayer(nearbyQuakeLayer);
                syncLayerCheckbox(nearbyQuakeLayer, false);
            }
        });

        map.on('overlayremove', function(e) {
            if (e.name === 'Quakes near airports'
                    || e.name === 'All quakes in region') {
                highlightedQuakes = [];
            }
        });

        // --- Click-to-highlight ---
        var selectedAirport = null;
        var highlightedConnections = [];
        var highlightedQuakes = [];
        var autoAddedLayers = [];
        var justSelected = false;

        function selectAirport(iata, markerLayer) {
            clearSelection();
            selectedAirport = iata;

            // Highlight the clicked marker
            var el = markerLayer.getElement();
            if (el) el.classList.add('airport-selected');

            // Find matching connections
            connectionLayer.eachLayer(function(layer) {
                if (layer.feature.properties.airport_iata === iata) {
                    highlightedConnections.push(layer);
                    layer.setStyle({
                        color: '#2563eb',
                        weight: 4,
                        dashArray: null,
                        opacity: 0.9,
                    });
                    layer.bringToFront();
                }
            });

            // Collect connected earthquake IDs
            var linkedQuakeIds = {};
            highlightedConnections.forEach(function(layer) {
                linkedQuakeIds[
                    layer.feature.properties.earthquake_id] = true;
            });

            // Auto-add layers if they are OFF
            if (!map.hasLayer(connectionLayer)) {
                map.addLayer(connectionLayer);
                autoAddedLayers.push(connectionLayer);
            }
            if (!map.hasLayer(nearbyQuakeLayer)
                    && !map.hasLayer(allQuakeLayer)) {
                map.addLayer(nearbyQuakeLayer);
                autoAddedLayers.push(nearbyQuakeLayer);
            }

            // Highlight matching earthquakes
            function highlightQuakeLayer(qLayer) {
                qLayer.eachLayer(function(layer) {
                    var qid = layer.feature.properties.earthquake_id;
                    if (linkedQuakeIds[qid]) {
                        layer._origStyle = {
                            radius: layer.getRadius(),
                            fillColor: layer.options.fillColor,
                            color: layer.options.color,
                            weight: layer.options.weight,
                            fillOpacity: layer.options.fillOpacity,
                        };
                        highlightedQuakes.push(layer);
                        layer.setStyle({
                            fillColor: '#ef4444',
                            color: '#dc2626',
                            weight: 2,
                            fillOpacity: 0.7,
                        });
                        layer.setRadius(
                            layer.getRadius() * 1.3);
                        layer.bringToFront();
                    }
                });
            }

            if (map.hasLayer(nearbyQuakeLayer))
                highlightQuakeLayer(nearbyQuakeLayer);
            if (map.hasLayer(allQuakeLayer))
                highlightQuakeLayer(allQuakeLayer);
        }

        function clearSelection() {
            if (!selectedAirport) return;

            // Remove airport highlight
            airportLayer.eachLayer(function(layer) {
                var el = layer.getElement();
                if (el) el.classList.remove('airport-selected');
            });

            // Reset connection styles
            highlightedConnections.forEach(function(layer) {
                connectionLayer.resetStyle(layer);
            });
            highlightedConnections = [];

            // Reset quake styles
            highlightedQuakes.forEach(function(layer) {
                if (layer._origStyle) {
                    layer.setStyle({
                        fillColor: layer._origStyle.fillColor,
                        color: layer._origStyle.color,
                        weight: layer._origStyle.weight,
                        fillOpacity: layer._origStyle.fillOpacity,
                    });
                    layer.setRadius(layer._origStyle.radius);
                }
            });
            highlightedQuakes = [];

            // Remove auto-added layers
            autoAddedLayers.forEach(function(layer) {
                map.removeLayer(layer);
            });
            autoAddedLayers = [];

            selectedAirport = null;
        }

        map.on('click', function() {
            if (justSelected) {
                justSelected = false;
                return;
            }
            clearSelection();
        });
    </script>
</body>
</html>